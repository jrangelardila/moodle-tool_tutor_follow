{"version":3,"file":"div4.min.js","sources":["../src/div4.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Handles the dashboard interactions for tutor follow-up data.\n *\n * @module     tool_tutor_follow/div4\n * @package    tool_tutor_follow\n * @copyright  2025 Jhon Rangel Ardila\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine([\n    \"jquery\",\n    'core/ajax',\n    'core/notification',\n    'tool_tutor_follow/charts',\n    'core/str',\n    'core/yui',\n    'core_form/modalform',\n], function ($, ajax, notification, chartModule, Str, Y, ModalForm) {\n    return {\n        init: function () {\n            $(\".more-info\").click(async function (event) {\n                const number = event.currentTarget.id;\n\n                const options = {\n                    methodname: 'tool_tutor_follow_get_data_course_for_user',\n                    args: {\n                        id: number\n                    },\n                };\n\n                const response = await ajax.call([options])[0];\n                const userObject = JSON.parse(response);\n                this.executeStudentGraph(userObject, number);\n\n            }.bind(this));\n        },\n\n        executeStudentGraph: async function (obj, idnumber) {\n            $(\".data-body\").empty();\n\n            const strings = [\n                { key: 'close', component: 'tool_tutor_follow' },\n                { key: 'distributionstudents', component: 'tool_tutor_follow' },\n                { key: 'number', component: 'tool_tutor_follow' },\n                { key: 'shortname', component: 'tool_tutor_follow' },\n                { key: 'course', component: 'tool_tutor_follow' },\n                { key: 'studentscount', component: 'tool_tutor_follow' },\n                { key: 'students', component: 'tool_tutor_follow' }\n            ];\n\n            const results = await Str.get_strings(strings);\n            const [\n                closeText,\n                distributionText,\n                numberText,\n                shortnameText,\n                courseText,\n                studentsCountText,\n                studentsText\n            ] = results;\n\n            $(\".data-body\").append(`\n                <div class=\"w-100 align-items-end\">\n                    <div type=\"button\" class=\"btn btn-danger btn-close-students\">\n                        <i class=\"fas fa-times\"></i> ${closeText}\n                    </div>\n                </div>`);\n\n            let chart = $(`\n                <h4 class=\"text-primary\">${distributionText} ${obj.firstname} ${obj.lastname}</h4>\n                <div class=\"container\">\n                    <canvas id=\"firstchart\"></canvas>\n                </div>`);\n            $(\".data-body\").append(chart);\n\n            const fullnames = obj.cursos.map(course => course.fullname);\n            const students = obj.cursos.map(course => course.students);\n            const shortnames = obj.cursos.map(course => course.shortname);\n\n            const chartData = {\n                type: 'pie',\n                series: [{\n                    label: studentsText,\n                    labels: fullnames,\n                    values: students,\n                    colors: [],\n                    axes: {x: null, y: null},\n                    smooth: null\n                }],\n                labels: fullnames,\n                title: `${obj.firstname} ${obj.lastname}`,\n                axes: {x: [], y: []},\n                config_colorset: null,\n                doughnut: null\n            };\n\n\n            chartModule.print_chart(chartData, \"firstchart\");\n\n            const numeros = Array.from({length: fullnames.length}, (v, k) => k + 1);\n            chartModule.print_table_data(\".data-body\",\n                [numberText, shortnameText, courseText, studentsCountText],\n                [numeros, shortnames, fullnames, students]);\n\n            $(\".btn-close-students\").click(function (event) {\n                this.calification_btn(event);\n            }.bind(this));\n        },\n\n        calification_btn: function (e) {\n            $(\".data-body\").fadeOut(400, function () {\n                $(this).empty().fadeIn(400);\n            });\n        }\n    };\n});\n\n"],"names":["define","$","ajax","notification","chartModule","Str","Y","ModalForm","init","click","async","event","number","currentTarget","id","options","methodname","args","response","call","userObject","JSON","parse","this","executeStudentGraph","bind","obj","idnumber","empty","results","get_strings","key","component","closeText","distributionText","numberText","shortnameText","courseText","studentsCountText","studentsText","append","chart","firstname","lastname","fullnames","cursos","map","course","fullname","students","shortnames","shortname","chartData","type","series","label","labels","values","colors","axes","x","y","smooth","title","config_colorset","doughnut","print_chart","numeros","Array","from","length","v","k","print_table_data","calification_btn","e","fadeOut","fadeIn"],"mappings":";;;;;;;;AAwBAA,OAAO,yBAAA,CACH,SACA,YACA,oBACA,2BACA,WACA,WACA,wBACD,SAAUC,EAAGC,KAAMC,aAAcC,YAAaC,IAAKC,EAAGC,WACrD,MAAO,CACHC,KAAM,WACFP,EAAE,cAAcQ,MAAMC,eAAgBC,OAClC,MAAMC,OAASD,MAAME,cAAcC,GAE7BC,QAAU,CACZC,WAAY,6CACZC,KAAM,CACFH,GAAIF,SAINM,eAAiBhB,KAAKiB,KAAK,CAACJ,UAAU,GACtCK,WAAaC,KAAKC,MAAMJ,UAC9BK,KAAKC,oBAAoBJ,WAAYR,OAEzC,EAAEa,KAAKF,MACV,EAEDC,oBAAqBd,eAAgBgB,IAAKC,UACtC1B,EAAE,cAAc2B,QAEhB,MAUMC,cAAgBxB,IAAIyB,YAVV,CACZ,CAAEC,IAAK,QAASC,UAAW,qBAC3B,CAAED,IAAK,uBAAwBC,UAAW,qBAC1C,CAAED,IAAK,SAAUC,UAAW,qBAC5B,CAAED,IAAK,YAAaC,UAAW,qBAC/B,CAAED,IAAK,SAAUC,UAAW,qBAC5B,CAAED,IAAK,gBAAiBC,UAAW,qBACnC,CAAED,IAAK,WAAYC,UAAW,wBAK9BC,UACAC,iBACAC,WACAC,cACAC,WACAC,kBACAC,cACAV,QAEJ5B,EAAE,cAAcuC,OAAO,kMAGoBP,iEAI3C,IAAIQ,MAAQxC,EAAE,8CACiBiC,oBAAoBR,IAAIgB,aAAahB,IAAIiB,yIAIxE1C,EAAE,cAAcuC,OAAOC,OAEvB,MAAMG,UAAYlB,IAAImB,OAAOC,KAAIC,QAAUA,OAAOC,WAC5CC,SAAWvB,IAAImB,OAAOC,KAAIC,QAAUA,OAAOE,WAC3CC,WAAaxB,IAAImB,OAAOC,KAAIC,QAAUA,OAAOI,YAE7CC,UAAY,CACdC,KAAM,MACNC,OAAQ,CAAC,CACLC,MAAOhB,aACPiB,OAAQZ,UACRa,OAAQR,SACRS,OAAQ,GACRC,KAAM,CAACC,EAAG,KAAMC,EAAG,MACnBC,OAAQ,OAEZN,OAAQZ,UACRmB,MAAO,GAAGrC,IAAIgB,aAAahB,IAAIiB,WAC/BgB,KAAM,CAACC,EAAG,GAAIC,EAAG,IACjBG,gBAAiB,KACjBC,SAAU,MAId7D,YAAY8D,YAAYd,UAAW,cAEnC,MAAMe,QAAUC,MAAMC,KAAK,CAACC,OAAQ1B,UAAU0B,SAAS,CAACC,EAAGC,IAAMA,EAAI,IACrEpE,YAAYqE,iBAAiB,aACzB,CAACtC,WAAYC,cAAeC,WAAYC,mBACxC,CAAC6B,QAASjB,WAAYN,UAAWK,WAErChD,EAAE,uBAAuBQ,MAAM,SAAUE,OACrCY,KAAKmD,iBAAiB/D,MAC1B,EAAEc,KAAKF,MACV,EAEDmD,iBAAkB,SAAUC,GACxB1E,EAAE,cAAc2E,QAAQ,KAAK,WACzB3E,EAAEsB,MAAMK,QAAQiD,OAAO,IAC3B,GACJ,EAER"}